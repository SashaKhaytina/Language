PUSH 0 POP REX

IN 
POP [2 + REX]

PUSH [2 + REX] CALL fact POP [4 + REX]

PUSH [4 + REX] OUT 


HLT


fact:

PUSH REX 
PUSH REX PUSH 100 ADD POP REX

POP RCX POP RDX
POP [2 + REX] 
PUSH RDX PUSH RCX
PUSH 1 POP [3 + REX]

PUSH [2 + REX] PUSH 1 JNE IF0
PUSH 1 POP [2 + REX]

PUSH 1 POP [3 + REX]


IF0:

PUSH [2 + REX] PUSH 1 JE IF1
PUSH 1 PUSH [2 + REX] SUB 
CALL fact POP [3 + REX]


IF1:

PUSH [2 + REX] PUSH [3 + REX] MUL 

POP RAX

POP REX

POP RBX

PUSH RAX

PUSH RBX

RET



